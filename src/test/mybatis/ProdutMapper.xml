<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="product">
   <sql id="dateFormat">
      TO_CHAR(regdate,'YYYY"년"MM"월"DD"일" HH24:MI') regdate
   </sql>
   
   <insert id="insert" parameterType="productDto"  >
      INSERT INTO product (
      productNum ,
      productName,
      brand ,
      content,
      price,
      regdate)
      VALUES (
      product_seq.NEXTVAL,
      #{productNum},
      #{productName},
      #{brand},
      #{content},
      #{price},
      SYSDATE)
   </insert>
   
   <delete id="delete" parameterType="productDto" >
      DELETE FROM product
      WHERE productNum = #{productNum}
   </delete>
   
   <update id="update" parameterType="productDto" >
      UPDATE product
      SET 
      productName=#{productName},
      brand=#{brand},
      content=#{content},
      price=#{price}
      WHERE productNum = #{productNum}
   </update>
   
   <select id="getData" parameterType="int" resultType="productDto">
     
      SELECT result1.*
		FROM 
			(SELECT productNum,productName,brand,content,,price,<include refid="dateFormat"></include>, 
			LAG(productNum, 1, 0) OVER(ORDER BY productNum DESC) AS prevNum,
			LEAD(productNum, 1, 0) OVER(ORDER BY productNum DESC) AS nextNum
			FROM product
			ORDER BY productNum DESC) result1
			WHERE productNum=#{productNum}
	</select>
  
   
   <select id="getList" parameterType="productDto" resultType="productDto">
   		SELECT *
		FROM
			(SELECT result1.*, ROWNUM rnum
			FROM (productNum,productName,brand,content,price,<include refid="dateFormat"></include>
				  FROM product
				  ORDER BY productNum DESC
				  ) result1
				  	)
		WHERE rnum BETWEEN #{startRowNum} AND #{endRowNum}
   </select>
</mapper>